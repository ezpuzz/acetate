<div class="min-h-0 grow overflow-auto flex flex-col gap-y-2 px-2">
    {% for release in releases %}
    <div id="release{{release.id}}" class="rounded sm:p-2 border sm:flex bg-slate-100 shadow">
        <div class="w-full sm:w-1/3 flex gap-2 p-2 sm:p-0 sm:pr-4">
            <div class="w-full">
                <div class="float-right flex-none w-24 h-24 bg-gray-500"><img class="inset-full object-cover"
                        src="{{release.thumb|d()}}" /> Login to see covers.</div>

                <div>
                    <h2 class="text-lg leading-none"><a target="_blank"
                            href="https://discogs.com/release/{{release.id}}"
                            class="hover:underline">{{release.title}}</a></h2>
                    <span class="text-slate-500 text-xs">by</span> {{release.artists|map(attribute="name")|join(', ')}}
                </div>
                <dl class="*:mb-2">
                    <div class="hidden sm:block">
                        <dt class="text-xs text-slate-700">Label</dt>
                        {% for label in release.labels %}
                        <dd>
                            <a href="https://discogs.com/label/{{label.id}}" class="hover:underline">{{label.name}}</a>
                            <br />
                            <span class="text-slate-400 text-xs">{{label.catno}}</span>
                        </dd>
                        {% endfor %}
                    </div>
                    <div class="">
                        <dt class="text-xs text-slate-700">Format</dt>{% if release.formats is defined %}
                        {% for f in release.formats %}
                        <dd>
                            {{f.text|d()}}
                            {{f.descriptions|d()|join(' ')}} {{f.name|d()}}
                        </dd>{% endfor %} {% endif %}
                    </div>
                    <div class="hidden sm:block">
                        <dt class="text-xs text-slate-700">Released</dt>
                        <dd>{% if release.released is defined %}{{release.released}}{% endif %}</dd>
                    </div>
                    <div class="hidden sm:block">
                        <dt class="text-xs text-slate-700">Genres</dt>
                        <dd>{{release.genres|join(', ')}}</dd>
                    </div>
                    <div class="hidden sm:block">
                        <dt class="text-xs text-slate-700">Styles</dt>
                        <dd>{{release.styles|d(['Unknown'])|join(', ')}}</dd>
                    </div>
                    <div class="w-full hidden sm:block">
                        <dt class="text-xs text-slate-700">Tracks</dt>
                        {% for track in release.tracklist %}
                        <dd class="text-xs flex gap-2">
                            <div class="text-slate-400">{{track.position|d()}}</div> {{track.title|d('Untitled')}}
                            <div class="grow"></div> {{track.duration|d('')}}
                        </dd>
                        {% endfor %}
                    </div>
                    <div class="w-full hidden sm:block">
                        <dt class="text-xs text-slate-700">Notes</dt>
                        <dd>
                            <pre class="text-wrap">{{release.notes|d('')}}</pre>
                        </dd>
                    </div>
                </dl>
                {#
                <pre class="w-full text-wrap overflow-auto h-64 text-slate-400">{{release}}</pre> #}
                <div>
                    <input type="hidden" name="release_id" value="{{release.id}}" />
                    <button hx-post="/want" hx-target="closest div" hx-trigger="click" hx-include="closest div"
                        class="border rounded p-2 bg-emerald-400 hover:bg-emerald-700">I want this.</button>
                    <button hx-post="/hate" hx-target="#release{{release.id}}" hx-trigger="click"
                        hx-include="closest div" class="border rounded p-2 bg-rose-400 hover:bg-rose-700">I hate
                        this.</button>
                </div>

            </div>

        </div>
        {% if release.videos is defined %}
        <div class="w-full sm:w-2/3">
            <iframe
                src="https://www.youtube.com/embed/?playlist={{release.videos|join(',')}}&version=3&fs=0&enablejsapi=0&rel=0"
                frameborder="0" allow="autoplay; encrypted-media" allowfullscreen class="w-full aspect-video"></iframe>
            {#
            <pre class="text-wrap">{{release.videos}}</pre> #}
        </div>
        {% endif %}
    </div>
    {% endfor %}
</div>

<div id="pagination" class="flex-none w-full h-16 flex items-center px-4 gap-4 border-t bg-slate-200">
    <div class="text-nowrap"><span class="font-bold">{{from|int+1}} - {{from|int+pageSize|int}}</span> of <span
            class="font-bold">{{hits}}</span>
    </div>
    <div class="grow"></div>
    <div class="hidden sm:block">
        <select name="pageSize" hx-get="/releases" hx-replace-url="true" hx-target="#results"
            hx-include="#search, #filters, #pagination" class="border rounded-md p-2">
            <option value="5" {{"selected" if pageSize=="5" }}>5 per page</option>
            <option value="10" {{"selected" if pageSize=="10" }}>10 per page</option>
            <option value="25" {{"selected" if pageSize=="25" }}>25 per page (Pro)</option>
        </select>
    </div>
    <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
            class="size-6 flex-none {% if page|int < 2 %}text-slate-500 pointer-events-none{% else %}cursor-pointer{% endif %}"
            hx-get="/releases" hx-target="#results" hx-trigger="click" hx-include="#search, #filters, #pagination"
            hx-vals='{"page": "{{page|int - 1}}"}' hx-push-url="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5" />
        </svg>
        <input name="page" type="number" class="border mx-2 p-2 w-16" value="{{page|int}}" hx-get="/releases"
            hx-target="#results" hx-push-url="true" hx-trigger="input changed delay:500ms"
            hx-include="#search, #filters, #pagination" />
        of
        {{hits//pageSize|int}}
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"
            class="size-6 flex-none cursor-pointer" hx-get="/releases" hx-target="#results" hx-trigger="click"
            hx-include="#search, #filters, #pagination" hx-vals='{"page": "{{page|int + 1}}"}' hx-push-url="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5" />
        </svg>
    </div>
</div>